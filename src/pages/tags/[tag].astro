---
import Layout from "../../layouts/Layout.astro";
import { getCollection, type CollectionEntry } from "astro:content";

// Use correct access to dynamic params
const { tag } = Astro.params;

// Provide a proper type for posts
const posts = (await getCollection("blog")) as CollectionEntry<"blog">[];

// Filter posts by tag
const filteredPosts = posts.filter(post => post.data.tags.includes(tag));
---

<Layout title={`Posts tagged: ${tag}`}>
  <h1>#{tag}</h1>
  <ul>
    {filteredPosts.map(post => (
      <li>
        <a href={`/blog/${post.slug}`}>{post.data.title}</a>
      </li>
    ))}
  </ul>
</Layout>
